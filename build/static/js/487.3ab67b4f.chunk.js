/*! For license information please see 487.3ab67b4f.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkfront=self.webpackChunkfront||[]).push([[487],{487:(e,a,l)=>{l.r(a),l.d(a,{default:()=>g});var t=l(43),s=l(3),r=l(784);const n=(0,r.A)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),o=(0,r.A)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);var i=l(673),d=l(579);const c=e=>{let{car:a,onClose:l}=e;const[r,n]=(0,t.useState)({startDate:"",endDate:"",locationCity:"",totalPrice:0}),[o,c]=(0,t.useState)(!1),[u,m]=(0,t.useState)(""),[b,h]=(0,t.useState)(""),x=(0,s.wA)(),g=e=>{const{name:a,value:l}=e.target;n({...r,[a]:l})},p=(0,t.useCallback)((async e=>{if(e.preventDefault(),new Date(r.startDate)>=new Date(r.endDate)&&(m("La date de fin doit \xeatre post\xe9rieure \xe0 la date de d\xe9but."),h("error"),1))return;if(!localStorage.getItem("AUTH_TOKEN_KEY"))return m("Vous n'\xeates pas connect\xe9"),h("error"),void(window.location.href="/login");const{startDate:t,endDate:s,locationCity:n}=r,o={car:a.id,start_date:t,end_date:s,total_price:r.totalPrice,location_city:n,is_valid:!1};try{c(!0),m(""),console.log("Envoi de la r\xe9servation:",r),await x((0,i.$2)(o)),console.log(u,b),setTimeout((()=>{m(""),l(),window.location.href="/users/rentals"}),1e3)}catch(d){console.error("Erreur lors de la r\xe9servation:",d),m("Erreur lors de la r\xe9servation. Veuillez r\xe9essayer."),h("error")}finally{c(!1)}}),[x,r,a.id,l]);return(0,t.useEffect)((()=>{const{startDate:e,endDate:l}=r;if(e&&l){const t=new Date(e),s=new Date(l)-t,r=Math.ceil(s/864e5);n(r>0?e=>({...e,totalPrice:a.price_per_day*r}):e=>({...e,totalPrice:0}))}else n((e=>({...e,totalPrice:0})))}),[r.startDate,r.endDate,a.price_per_day]),(0,d.jsx)("div",{className:"fixed inset-0 flex h-full  items-center justify-center bg-black bg-opacity-50 z-50",children:(0,d.jsxs)("div",{className:"bg-white p-4  rounded-lg h-2/3 sm:h-auto    shadow-lg max-w-md w-full aspect-square mx-auto",children:[u&&(0,d.jsx)("div",{className:"mb-4 px-4 py-2 rounded-lg text-white font-semibold transition-opacity duration-500   "+("success"===b?"bg-green-600":"bg-red-600"),children:u}),o&&(0,d.jsx)("div",{className:"text-blue-600 mb-4",children:"Chargement..."}),(0,d.jsx)("h2",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"R\xe9server le v\xe9hicule"}),(0,d.jsxs)("div",{className:"mb-6 p-4 border border-gray-300 rounded-lg",children:[(0,d.jsxs)("p",{className:"text-gray-600",children:["Mod\xe8le:"," ",(0,d.jsxs)("span",{className:"font-semibold",children:[a.brand," ",a.model]})]}),(0,d.jsxs)("p",{className:"text-gray-600",children:["Prix par jour:"," ",(0,d.jsxs)("span",{className:"font-semibold text-red-700",children:[a.price_per_day," DH"]})]})]}),(0,d.jsxs)("form",{onSubmit:p,children:[(0,d.jsxs)("div",{className:"mb-1",children:[(0,d.jsx)("label",{className:"block text-gray-600 mb-2",htmlFor:"startDate",children:"Date de d\xe9but:"}),(0,d.jsx)("input",{type:"date",id:"startDate",name:"startDate",value:r.startDate,onChange:g,className:"w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,d.jsxs)("div",{className:"mb-1",children:[(0,d.jsx)("label",{className:"block text-gray-600 mb-2",htmlFor:"endDate",children:"Date de fin:"}),(0,d.jsx)("input",{type:"date",id:"endDate",name:"endDate",value:r.endDate,onChange:g,className:"w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,d.jsxs)("div",{className:"mb-3",children:[(0,d.jsx)("label",{className:"block text-gray-600 mb-2",htmlFor:"locationCity",children:"Ville de location:"}),(0,d.jsx)("input",{type:"text",id:"locationCity",name:"locationCity",value:r.locationCity,onChange:g,className:"w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,d.jsx)("div",{className:"mb-1",children:(0,d.jsxs)("p",{className:"text-gray-600 mb-0.5",children:["Prix total:"," ",(0,d.jsxs)("span",{className:"font-bold",children:[r.totalPrice," DH"]})]})}),(0,d.jsxs)("div",{className:"flex justify-center gap-0.5 mt-5 lg:mt-0",children:[(0,d.jsx)("button",{type:"submit",className:"bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition duration-300",disabled:o,children:o?"Chargement...":"Soumettre"}),(0,d.jsx)("button",{type:"button",onClick:l,className:"bg-red-500 text-white py-2 px-4 rounded-lg hover:bg-red-600 transition duration-300",children:"Annuler"})]})]})]})})};var u=l(975),m=l(225);const b=(0,t.lazy)((()=>l.e(804).then(l.bind(l,804)))),h=(0,t.lazy)((()=>l.e(887).then(l.bind(l,887)))),x=(0,t.lazy)((()=>l.e(471).then(l.bind(l,471)))),g=()=>{const e=(0,s.wA)(),[a,l]=(0,t.useState)(!1),[r,g]=(0,t.useState)(null),{cars:p,loading:f,error:v,pagination:y}=(0,s.d4)((e=>e.carRental)),[j,C]=(0,t.useState)({brand:"",model:""}),w=(0,t.useMemo)((()=>[{value:"BMW",label:"BMW",models:["Serie 3","Serie 5","X5"]},{value:"Audi",label:"Audi",models:["A3","A4","Q5","Q8 e-tron","A7"]},{value:"Dacia",label:"Dacia",models:["Logan","Sandero Stepway","Sandero"]},{value:"Mercedes-Benz",label:"Mercedes-Benz",models:["Classe A","Classe C","E-Class","GLE"]},{value:"Volkswagen",label:"Volkswagen",models:["Golf","Passat","Tiguan","Touareg"]},{value:"Porsche",label:"Porsche",models:["911","Cayenne","Macan"]},{value:"Hyundai",label:"Hyundai",models:["Accent","Tucson"]},{value:"Renault",label:"Renault",models:["Clio","Captur","M\xe9gane"]},{value:"Peugeot",label:"Peugeot",models:["208","3008","508"]},{value:"Citro\xebn",label:"Citro\xebn",models:["C3","C4","C5 Aircross"]},{value:"DS Automobiles",label:"DS Automobiles",models:["DS3","DS4","DS7"]},{value:"Alpine",label:"Alpine",models:["A110"]},{value:"Fiat",label:"Fiat",models:["500","Panda","Tipo"]},{value:"Alfa Romeo",label:"Alfa Romeo",models:["Giulia","Stelvio","Mito"]},{value:"Lancia",label:"Lancia",models:["Ypsilon","Delta"]},{value:"Ferrari",label:"Ferrari",models:["488","Portofino","Roma"]},{value:"Maserati",label:"Maserati",models:["Ghibli","Levante","Quattroporte"]},{value:"Toyota",label:"Toyota",models:["Corolla","Camry","Hilux"]},{value:"Honda",label:"Honda",models:["Civic","Accord","CR-V"]},{value:"Ford",label:"Ford",models:["Focus","Mustang","F-150"]}]),[]),[N,D]=(0,t.useState)(!0);(0,t.useEffect)((()=>{const a=setTimeout((()=>{(N||j.brand&&j.model)&&(e((0,i.Mp)({page:1,brand:j.brand,model:j.model})),D(!1))}),1e3);return()=>clearTimeout(a)}),[j.brand,j.model,e]);const A=(0,t.useCallback)((e=>{g(e),l(!0)}),[]);if(f)return(0,d.jsx)(d.Fragment,{children:(0,d.jsx)(x,{})});if(v)return(0,d.jsx)(d.Fragment,{children:(0,d.jsx)(x,{})});if(null!==p&&void 0!==p&&p.detail)return(0,d.jsxs)("div",{children:["Erreur: ",p.detail]});return(0,d.jsxs)("div",{className:"p-8",children:[a&&(0,d.jsx)("div",{className:"fixed top-0 left-0 w-full h-full flex justify-center items-center bg-black bg-opacity-50 z-50",children:(0,d.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-lg w-1/3",children:(0,d.jsx)(c,{car:r,onClose:()=>{l(!1),g(null)}})})}),(0,d.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"Nos Voitures Disponibles"}),(0,d.jsx)(t.Suspense,{fallback:(0,d.jsx)("div",{children:"Loading filters..."}),children:(0,d.jsx)(h,{brands:w,onFilterChange:e=>{console.log("Changement de filtres :",e),C((a=>({...a,...e})))}})}),(0,d.jsx)("div",{id:"cars",className:"  flex-  justify-center  w-full      ",children:(0,d.jsx)(u.RC,{navigation:!0,modules:[m.Vx],spaceBetween:1,slidesPerView:1,breakpoints:{640:{slidesPerView:1},1024:{slidesPerView:4}},children:(Array.isArray(p)?p:[]).slice(0,8).map((e=>(0,d.jsx)(u.qr,{className:"  ",children:(0,d.jsx)("div",{className:" flex justify-center w-full ",id:"cars",children:(0,d.jsx)(t.Suspense,{fallback:(0,d.jsx)("div",{children:"Loading ..."}),children:(0,d.jsx)(b,{car:e,onReserveClick:A})})})},e.id)))})}),(0,d.jsxs)("div",{className:"mt-6 flex justify-between",children:[(0,d.jsx)("button",{onClick:()=>{y.previous&&e((0,i.Mp)({page:y.currentPage-1,brand:j.brand,model:j.model}))},disabled:!y.previous,className:"p-2 bg-gray-300 rounded-full hover:bg-gray-400 disabled:opacity-50",name:"next",children:(0,d.jsx)(n,{size:24,className:"text-gray-800"})}),(0,d.jsxs)("h3",{children:[" Page ",y.currentPage," "]}),(0,d.jsx)("button",{onClick:()=>{console.log(y.next),y.currentPage&&e((0,i.Mp)({page:y.currentPage+1,brand:j.brand,model:j.model}))},name:"prv",disabled:!y.next,className:"p-2 bg-blue-600 text-white rounded-full hover:bg-blue-700 disabled:opacity-50",children:(0,d.jsx)(o,{size:24,className:"text-white"})})]})]})}}}]);
//# sourceMappingURL=487.3ab67b4f.chunk.js.map